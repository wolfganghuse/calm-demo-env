{"status":{},"contains_secrets":false,"product_version":"2.9.7","spec":{"description":"Provides VDI-Desktops and assigns them to a GuacamoleBroker","resources":{"client_attrs":{"36d8fca6_deployment":{"y":269.5,"x":536.5}},"service_definition_list":[{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"VDIService"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"AddConnection"},{"kind":"app_task","name":"AssignUser"}],"name":"60a3d1a7_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"AddConnection"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"AssignUser"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"VDIService"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"AddConnection","attrs":{"exit_status":[],"script":"\n# Set  headers\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\npayload = '{\"parentIdentifier\":\"@@{calm_array_GroupIdentifier}@@\",\"name\":\"@@{name}@@\",\"protocol\":\"rdp\",\"parameters\":{\"port\":\"\",\"read-only\":\"\",\"swap-red-blue\":\"\",\"cursor\":\"\",\"color-depth\":\"\",\"clipboard-encoding\":\"\",\"dest-port\":\"\",\"recording-exclude-output\":\"\",\"recording-exclude-mouse\":\"\",\"recording-include-keys\":\"\",\"create-recording-path\":\"\",\"enable-sftp\":\"\",\"sftp-port\":\"\",\"sftp-server-alive-interval\":\"\",\"enable-audio\":\"\",\"hostname\":\"@@{address}@@\",\"security\":\"nla\",\"disable-auth\":\"\",\"ignore-cert\":\"true\",\"gateway-port\":\"\",\"server-layout\":\"\",\"console\":\"\",\"width\":\"\",\"height\":\"\",\"dpi\":\"\",\"resize-method\":\"\",\"console-audio\":\"\",\"disable-audio\":\"\",\"enable-audio-input\":\"\",\"enable-printing\":\"\",\"enable-drive\":\"\",\"create-drive-path\":\"\",\"enable-wallpaper\":\"\",\"enable-theming\":\"\",\"enable-font-smoothing\":\"\",\"enable-full-window-drag\":\"\",\"enable-desktop-composition\":\"\",\"enable-menu-animations\":\"\",\"disable-bitmap-caching\":\"\",\"disable-offscreen-caching\":\"\",\"disable-glyph-caching\":\"\",\"preconnection-id\":\"\",\"username\":\"@@{LOCAL.username}@@\",\"password\":\"@@{LOCAL.secret}@@\"},\"attributes\":{\"max-connections\":\"\",\"max-connections-per-user\":\"\",\"weight\":\"\",\"failover-only\":\"\",\"guacd-port\":\"\",\"guacd-encryption\":\"\"}}'\n\n\nurl     = \"https:\/\/@@{Guacamole_IP}@@\/api\/session\/data\/mysql\/connections?token=@@{calm_array_authToken}@@\"\nresp = urlreq(url, verb='POST', headers=headers,params=payload,send_form_encoded_data='FALSE')\nif resp.ok:\n  print \"ConnectionIdentifier={0}\".format(json.loads(resp.content)['identifier'])\n\nelse:\n  print \"Add Connection failed\", json.dumps(json.loads(resp.content), indent=4)\n  exit(1)","eval_variables":["ConnectionIdentifier"],"eval_scope":"local","type":"","script_type":"static"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"VDIService"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"AssignUser","attrs":{"script":"\n# Set  headers\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\npayload = '[{\"op\":\"add\",\"path\":\"\/connectionGroupPermissions\/@@{calm_array_ParentGroup}@@\",\"value\":\"READ\"},{\"op\":\"add\",\"path\":\"\/connectionGroupPermissions\/@@{calm_array_GroupIdentifier}@@\",\"value\":\"READ\"},{\"op\":\"add\",\"path\":\"\/connectionPermissions\/@@{ConnectionIdentifier}@@\",\"value\":\"READ\"}]'\n\nurl     = \"https:\/\/@@{Guacamole_IP}@@\/\/api\/session\/data\/mysql\/users\/@@{VDIUser}@@\/permissions?token=@@{calm_array_authToken}@@\"\nresp = urlreq(url, verb='PATCH', headers=headers,params=payload,send_form_encoded_data='FALSE')\nif resp.ok:\n  print resp.content\n  #print \"GroupIdentifier={0}\".format(json.loads(resp.content)['identifier'])\nelse:\n  print \"Add Connection failed\", json.dumps(json.loads(resp.content), indent=4)\n  exit(1)","type":"","command_line_args":"","exit_status":[],"script_type":"static"},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"45aa70ae_runbook","main_task_local_reference":{"kind":"app_task","name":"60a3d1a7_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"VDIService"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"RemoveGroup"},{"kind":"app_task","name":"DeleteUser"}],"name":"baadee83_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"RemoveGroup"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"DeleteUser"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"VDIService"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"RemoveGroup","attrs":{"script":"if @@{calm_array_index}@@>0:\n  exit(0)\n\n# Set  headers\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\n\n# Get Cluster ID\nurl     = \"https:\/\/@@{Guacamole_IP}@@\/api\/session\/data\/mysql\/connectionGroups\/@@{GroupIdentifier}@@?token=@@{authToken}@@\"\nresp = urlreq(url, verb='DELETE', headers=headers)\nif resp.ok:\n  #print \"CLUSTER_ID={0}\".format(json.loads(resp.content)[0]['id'])\n  print resp.content\nelse:\n  print \"Delete Group failed\", json.dumps(json.loads(resp.content), indent=4)\n  exit(1)\n ","type":"","command_line_args":"","exit_status":[],"script_type":"static"},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"VDIService"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"DeleteUser","attrs":{"script":"# Set  headers\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\n\nurl     = \"https:\/\/@@{Guacamole_IP}@@\/api\/session\/data\/mysql\/users\/@@{VDIUser}@@?token=@@{calm_array_authToken}@@\"\nresp = urlreq(url, verb='DELETE', headers=headers)\nif resp.ok:\n  #print \"CLUSTER_ID={0}\".format(json.loads(resp.content)[0]['id'])\n  print resp.content\nelse:\n  print \"Delete Group failed\", json.dumps(json.loads(resp.content), indent=4)\n  exit(1)\n ","type":"","command_line_args":"","exit_status":[],"script_type":"static"},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"6ef9d68e_runbook","main_task_local_reference":{"kind":"app_task","name":"baadee83_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"VDIService"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"ad562827_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"b1bbe7b6_runbook","main_task_local_reference":{"kind":"app_task","name":"ad562827_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"VDIService"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"13b4a4a5_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"2f220ec2_runbook","main_task_local_reference":{"kind":"app_task","name":"13b4a4a5_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"VDIService"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"0bf484b3_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"e56a67ab_runbook","main_task_local_reference":{"kind":"app_task","name":"0bf484b3_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[],"name":"VDIService","port_list":[],"tier":"","variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"ParentGroup","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"authToken","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"GroupIdentifier","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"VDIUser","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"VDIPass","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"ConnectionIdentifier","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}}],"description":""}],"substrate_definition_list":[{"description":"","action_list":[{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"VDISeat"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"GetToken"},{"kind":"app_task","name":"GetParentGroup"},{"kind":"app_task","name":"CreateChildGroup"},{"kind":"app_task","name":"CreateUser"}],"name":"1f01e400_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"GetToken"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"GetParentGroup"}},{"from_task_reference":{"kind":"app_task","name":"GetParentGroup"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"CreateChildGroup"}},{"from_task_reference":{"kind":"app_task","name":"CreateChildGroup"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"CreateUser"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_substrate","name":"VDISeat"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"GetToken","attrs":{"exit_status":[],"script":"if @@{calm_array_index}@@>0:\n  exit(0)\n\n# Set  headers\nheaders = {'Content-Type': 'application\/x-www-form-urlencoded', 'Accept': 'application\/json'}\n\n# Get Cluster ID\nurl     = \"https:\/\/@@{Guacamole_IP}@@\/api\/tokens?username=@@{GuacamoleCredential.username}@@&password=@@{GuacamoleCredential.secret}@@\"\nresp = urlreq(url, verb='POST', headers=headers)\nif resp.ok:\n  #print \"CLUSTER_ID={0}\".format(json.loads(resp.content)[0]['id'])\n  print \"authToken={0}\".format(json.loads(resp.content)['authToken'])\nelse:\n  print \"Get authToken failed\", json.dumps(json.loads(resp.content), indent=4)\n  exit(1)","eval_variables":["authToken"],"eval_scope":"local","type":"","script_type":"static"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]},{"target_any_local_reference":{"kind":"app_substrate","name":"VDISeat"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"GetParentGroup","attrs":{"exit_status":[],"script":"if @@{calm_array_index}@@>0:\n  exit(0)\n\n# Set  headers\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\n\n# Get Cluster ID\nurl     = \"https:\/\/@@{Guacamole_IP}@@\/api\/session\/data\/mysql\/connectionGroups?token=@@{authToken}@@\"\nresp = urlreq(url, verb='GET', headers=headers)\nif resp.ok:\n  #print \"CLUSTER_ID={0}\".format(json.loads(resp.content)[0]['id'])\n  #print \"authToken={0}\".format(json.loads(resp.content)['authToken'])\n  ParentGroup=-1\n  for Group in json.loads(resp.content):\n    if json.loads(resp.content)[Group]['name']=='@@{GuacamoleGroup}@@':\n      ParentGroup=Group\n      print \"ParentGroup={0}\".format(ParentGroup)\n  if ParentGroup==-1:\n    print \"@@{GuacamoleGroup}@@ not found\"\n    exit(1)\nelse:\n  print \"Get Groups failed\", json.dumps(json.loads(resp.content), indent=4)\n  exit(1)","eval_variables":["ParentGroup"],"eval_scope":"local","type":"","script_type":"static"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]},{"target_any_local_reference":{"kind":"app_substrate","name":"VDISeat"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"CreateChildGroup","attrs":{"exit_status":[],"script":"if @@{calm_array_index}@@>0:\n  exit(0)\n\n# Set  headers\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\npayload = '{\"parentIdentifier\":\"@@{ParentGroup}@@\",\"name\":\"@@{SessionName}@@\",\"type\":\"ORGANIZATIONAL\",\"attributes\":{\"max-connections\":\"\",\"max-connections-per-user\":\"\",\"enable-session-affinity\":\"\"}}'\n# Get Cluster ID\nurl     = \"https:\/\/@@{Guacamole_IP}@@\/api\/session\/data\/mysql\/connectionGroups?token=@@{authToken}@@\"\nresp = urlreq(url, verb='POST', headers=headers,params=payload,send_form_encoded_data='FALSE')\nif resp.ok:\n  print \"GroupIdentifier={0}\".format(json.loads(resp.content)['identifier'])\nelse:\n  print \"Create Groups failed\", json.dumps(json.loads(resp.content), indent=4)\n  exit(1)","eval_variables":["GroupIdentifier"],"eval_scope":"local","type":"","script_type":"static"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]},{"target_any_local_reference":{"kind":"app_substrate","name":"VDISeat"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"CreateUser","attrs":{"exit_status":[],"script":"\n# Set  headers\nVDIUser = \"@@{SessionName}@@@@{calm_array_index}@@\"\nVDIPass = _construct_random_password(lower=5,puncs=\"\")\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\npayload = '{\"username\":\"'+VDIUser+'\",\"password\":\"'+VDIPass+'\",\"attributes\":{\"disabled\":\"\",\"expired\":\"\",\"access-window-start\":\"\",\"access-window-end\":\"\",\"valid-from\":\"\",\"valid-until\":\"\",\"timezone\":null}}'\nprint payload\n# Get Cluster ID\nurl     = \"https:\/\/@@{Guacamole_IP}@@\/api\/session\/data\/mysql\/users?token=@@{calm_array_authToken}@@\"\nresp = urlreq(url, verb='POST', headers=headers,params=payload,send_form_encoded_data='FALSE')\nif resp.ok:\n  print \"VDIUser=\"+VDIUser\n  print \"VDIPass=\"+VDIPass\n  #print \"GroupIdentifier={0}\".format(json.loads(resp.content)['identifier'])\nelse:\n  print \"Create USser failed\", json.dumps(json.loads(resp.content), indent=4)\n  exit(1)","eval_variables":["VDIUser","VDIPass"],"eval_scope":"local","type":"","script_type":"static"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]}],"description":"","name":"4e069d4f_runbook","main_task_local_reference":{"kind":"app_task","name":"1f01e400_dag"},"variable_list":[]},"name":"pre_action_create"},{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"VDISeat"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"48164c7b_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"008f5ecd_runbook","main_task_local_reference":{"kind":"app_task","name":"48164c7b_dag"},"variable_list":[]},"name":"post_action_delete"}],"type":"AHV_VM","name":"VDISeat","readiness_probe":{"connection_type":"POWERSHELL","retries":"5","connection_protocol":"","connection_port":5985,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"LOCAL"}},"editables":{"create_spec":{"resources":{"nic_list":{},"serial_port_list":{},"disk_list":{"0":{"data_source_reference":true}}}}},"os_type":"Windows","create_spec":{"name":"@@{SessionName}@@@@{calm_array_index}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"7923f6f6-483f-4dea-ade9-a02d781139f9"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":2,"gpu_list":[],"memory_size_mib":4096,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":null,"type":"","sysprep":{"is_domain":false,"install_type":"PREPARED","domain_credential_reference":null,"domain":"","dns_ip":"","dns_search_path":"","unattend_xml":"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<unattend xmlns=\"urn:schemas-microsoft-com:unattend\">\n   <settings pass=\"specialize\">\n      <component xmlns:wcm=\"http:\/\/schemas.microsoft.com\/WMIConfig\/2002\/State\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" name=\"Microsoft-Windows-Shell-Setup\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <ComputerName>@@{name}@@<\/ComputerName>\n         <RegisteredOrganization>Nutanix<\/RegisteredOrganization>\n         <RegisteredOwner>Acropolis<\/RegisteredOwner>\n         <TimeZone>UTC<\/TimeZone>\n      <\/component>\n      <component xmlns=\"\" name=\"Microsoft-Windows-TerminalServices-LocalSessionManager\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\" processorArchitecture=\"amd64\">\n         <fDenyTSConnections>false<\/fDenyTSConnections>\n      <\/component>\n      <component xmlns=\"\" name=\"Microsoft-Windows-TerminalServices-RDP-WinStationExtensions\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\" processorArchitecture=\"amd64\">\n         <UserAuthentication>0<\/UserAuthentication>\n      <\/component>\n      <component xmlns:wcm=\"http:\/\/schemas.microsoft.com\/WMIConfig\/2002\/State\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" name=\"Networking-MPSSVC-Svc\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <FirewallGroups>\n            <FirewallGroup wcm:action=\"add\" wcm:keyValue=\"RemoteDesktop\">\n               <Active>true<\/Active>\n               <Profile>all<\/Profile>\n               <Group>@FirewallAPI.dll,-28752<\/Group>\n            <\/FirewallGroup>\n         <\/FirewallGroups>\n      <\/component>\n   <\/settings>\n   <settings pass=\"oobeSystem\">\n      <component xmlns:wcm=\"http:\/\/schemas.microsoft.com\/WMIConfig\/2002\/State\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" name=\"Microsoft-Windows-Shell-Setup\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <UserAccounts>\n            <AdministratorPassword>\n               <Value>@@{LOCAL.secret}@@<\/Value>\n               <PlainText>true<\/PlainText>\n            <\/AdministratorPassword>\n         <\/UserAccounts>\n         <AutoLogon>\n            <Password>\n               <Value>@@{LOCAL.secret}@@<\/Value>\n               <PlainText>true<\/PlainText>\n            <\/Password>\n            <Enabled>true<\/Enabled>\n            <Username>Administrator<\/Username>\n         <\/AutoLogon>\n         <FirstLogonCommands>\n            <SynchronousCommand wcm:action=\"add\">\n               <CommandLine>cmd.exe \/c netsh firewall add portopening TCP 5985 \"Port 5985\"<\/CommandLine>\n               <Description>Win RM port open<\/Description>\n               <Order>1<\/Order>\n               <RequiresUserInput>true<\/RequiresUserInput>\n            <\/SynchronousCommand>\n            <SynchronousCommand wcm:action=\"add\">\n               <CommandLine>powershell -Command \"Enable-PSRemoting -SkipNetworkProfileCheck -Force\"<\/CommandLine>\n               <Description>Enable PS-Remoting<\/Description>\n               <Order>2<\/Order>\n               <RequiresUserInput>true<\/RequiresUserInput>\n            <\/SynchronousCommand>\n            <SynchronousCommand wcm:action=\"add\">\n               <CommandLine>powershell -Command \"Set-ExecutionPolicy -ExecutionPolicy RemoteSigned\"<\/CommandLine>\n               <Description>Enable Remote-Signing<\/Description>\n               <Order>3<\/Order>\n               <RequiresUserInput>false<\/RequiresUserInput>\n            <\/SynchronousCommand>\n         <\/FirstLogonCommands>\n         <OOBE>\n            <HideEULAPage>true<\/HideEULAPage>\n            <SkipMachineOOBE>true<\/SkipMachineOOBE>\n         <\/OOBE>\n      <\/component>\n      <component xmlns:wcm=\"http:\/\/schemas.microsoft.com\/WMIConfig\/2002\/State\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" name=\"Microsoft-Windows-International-Core\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <InputLocale>en-US<\/InputLocale>\n         <SystemLocale>en-US<\/SystemLocale>\n         <UILanguageFallback>en-us<\/UILanguageFallback>\n         <UILanguage>en-US<\/UILanguage>\n         <UserLocale>en-US<\/UserLocale>\n      <\/component>\n   <\/settings>\n<\/unattend>\n","type":""}},"power_state":"ON","type":"","account_uuid":"2524d569-1636-4955-9040-e704ab341f38","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"image","type":"","name":"Windows2016Template","uuid":"414f61b6-b94a-4782-894a-32601044595d"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]}],"credential_definition_list":[{"username":"administrator","description":"","type":"PASSWORD","secret":{"attrs":{"is_secret_modified":false,"secret_reference":{}}},"name":"LOCAL"},{"username":"guacadmin","description":"","type":"PASSWORD","secret":{"attrs":{"is_secret_modified":false,"secret_reference":{}}},"name":"GuacamoleCredential"}],"package_definition_list":[{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"VDIService"}],"name":"Package1","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package1"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"4c414a31_dag","state":"NOT_VALIDATED","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"026fe6a8_runbook","state":"NOT_VALIDATED","main_task_local_reference":{"kind":"app_task","name":"4c414a31_dag"},"message_list":[],"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package1"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"5beeb108_dag","state":"NOT_VALIDATED","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"75c6b723_runbook","state":"NOT_VALIDATED","main_task_local_reference":{"kind":"app_task","name":"5beeb108_dag"},"message_list":[],"variable_list":[]}},"variable_list":[]}],"app_profile_list":[{"deployment_create_list":[{"type":"GREENFIELD","action_list":[],"name":"36d8fca6_deployment","min_replicas":"@@{DesktopCount}@@","default_replicas":"","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"@@{DesktopCount}@@","package_local_reference_list":[{"kind":"app_package","name":"Package1"}],"substrate_local_reference":{"kind":"app_substrate","name":"VDISeat"},"variable_list":[],"description":""}],"description":"","action_list":[],"name":"Default","variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"New Deployments will be added under this group, must exist.","data_type":"BASE","type":"LOCAL","name":"GuacamoleGroup","value":"CalmManaged","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"Name of Desktop Session, used for VM-Prefix, User-Prefix, etc","data_type":"BASE","type":"LOCAL","name":"SessionName","value":"Schulung","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"regex":{"should_validate":false,"value":"^[\\d]*$"},"val_type":"INT","is_mandatory":false,"description":"Number of Desktops to be provisioned","data_type":"BASE","type":"LOCAL","name":"DesktopCount","value":"4","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"Guacamole_IP","value":"172.23.61.44","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"GroupIdentifier","value":"","label":"","attrs":{"type":""},"editables":{"value":false},"is_hidden":true,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"EXEC_LOCAL","name":"BaseImage","value":"","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"EXEC","attrs":{"script":"# Set creds and headers\n#prism_user = '@@{PrismElement.username}@@'\n#prism_pass = '@@{PrismElement.secret}@@'\n\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\npayload ='{ \"kind\": \"image\" }'\n#url     = \"https:\/\/@@{PrismElement_IP}@@:@@{PrismElement_Port}@@\/PrismGateway\/services\/rest\/v2.0\/storage_containers\/\"\nurl = \"https:\/\/172.23.0.15:9440\/api\/nutanix\/v3\/images\/list\"\n\n#resp = urlreq(url, verb='GET', auth='BASIC', user=prism_user, passwd=prism_pass, headers=headers)\nresp = urlreq(url, verb='POST', auth='BASIC', user='sa_prism_local', passwd='Nutanix\/4u', headers=headers, params=payload)\nif resp.ok:\n  for image in json.loads(resp.content)['entities']:\n    print image['status']['name']+\",\"\n ","type":"EXEC","command_line_args":"","exit_status":[],"script_type":"static"}}}]}],"published_service_definition_list":[],"default_credential_local_reference":{"kind":"app_credential","name":"LOCAL"},"type":"USER"},"name":"wh-GuacamoleIntegration"},"api_version":"3.0","metadata":{"last_update_time":"1571259122590562","kind":"blueprint","spec_version":71,"creation_time":"1571221152370879","name":"wh-GuacamoleIntegration"}}